graph:
  startId: Start
  nodes:
    - id: Start
      type: START
      title: Anza
      question: Anza
      nextId: Q1

    - id: Q1
      type: AI
      title: Hasara ya Mavuno kutokana na Funza wa Jeshi Vamizi (Misimu 3)
      question: >-
        Unapoteza mavuno kiasi gani kutokana na funza wa jeshi vamizi (FAW)? Tafadhali fikiria misimu mitatu iliyopita. (Asilimia au magunia kwa ekari ni sawa.)
      nextId: Q2

    - id: Q2
      type: AI
      title: Ubadilishanaji kwa Kuvuna Mapema kwa Siku 10
      question: >-
        Ikiwa ungeweza kuvuna siku 10 mapema, ungekuwa tayari kupunguza mavuno kiasi gani? (Asilimia au magunia kwa ekari.)
      nextId: Q3

    - id: Q3
      type: AI
      title: Kizingiti cha Uharibifu cha Kubadili Aina ya Mahindi
      question: >-
        Ni kiwango gani cha uharibifu wa wadudu au magonjwa kingekufanya uache kutumia aina yako ya sasa ya mahindi na ubadilishe kwenda aina mpya? (Toa kigezo wazi, kwa mfano: asilimia ya mimea au masikio yaliyoharibika, au kiwango cha ukali.)
      nextId: Q4

    - id: Q4
      type: AI
      title: Matarajio ya Aina Mpya ya Kuchukua Nafasi
      question: >-
        Ungetarajia nini kutoka kwa aina mpya ya mahindi ili kuchukua nafasi ya ile unayolima sasa? Tafadhali toa maelezo kwa undani kadiri inavyowezekana (kwa mfano, muda wa kukomaa (DTM), uvumilivu wa FAW, uvumilivu wa ukame katika hatua fulani, mavuno ya kawaida).
      nextId: Q5

    - id: Q5
      type: AI
      title: Mavuno ya Chini Yanayokubalika Katika Mwaka Mbaya
      question: >-
        Katika mwaka mbaya, ni mavuno madogo kiasi gani ambayo ungeyakubali na bado ukapande mahindi haya tena msimu unaofuata? (Asilimia ya mavuno ya kawaida au magunia kwa ekari.)
      nextId: Q6

    - id: Q6
      type: AI
      title: Wakati wa Ukame Unaoharibu Zaidi
      question: >-
        Ni kipindi gani katika msimu ambapo ukame unaathiri mazao yako kwa kiwango kikubwa zaidi? Ni wakati gani wa ukame ambao ni mgumu zaidi kwako? (Kwa mfano, kabla ya kutoa maua, wakati wa kutoa maua/kuchanua, kujaza punje, kabla ya kuvuna.)
      nextId: Review

    - id: Review
      type: REVIEW
      title: Kagua
      question: ''
      nextId: Done

    - id: Done
      type: DONE
      title: Imekamilika
      question: ''

slm:
  accelerator: "GPU"

  # Reliability-tuned generation defaults (recommended)
  max_tokens: 256
  top_k: 20
  top_p: 0.9
  temperature: 0.2
  repetition_penalty: 1.1

  user_turn_prefix: "<start_of_turn>user"
  model_turn_prefix: "<start_of_turn>model"
  turn_end: "<end_of_turn>"

  empty_json_instruction: "Jibu kwa kitu tupu cha JSON: {}"
  preamble: "Wewe ni mtaalamu mashuhuri wa tafiti za wakulima. Soma Swali na Jibu."

  key_contract: |
    MUUNDO WA MATOKEO:
    - Thamani zote ziwe kwa Kiswahili.
    - Vifunguo (keys):
      • "analysis": sentensi fupi
      • "expected_answer": sentensi fupi
      • "follow_up_question": swali 1 fupi la kuthibitisha/kukagua (SI orodha/array)
      • "score": nambari kamili 1–100

    DHAMIRA YA SWALI LA UFUATILIAJI:
    - Swali la ufuatiliaji lazima lithibitishe au lifafanue jibu la mhojiwa kuhusu swali HILO HILO.
    - Lilengwe pengo kubwa zaidi: kipimo/kiasi hakipo, namba haipo, kipindi cha muda hakijawekwa, msingi wa kulinganisha (baseline) haupo, au njia iliyotumika haijaelezwa.
    - Liwe la jambo moja tu (si swali lenye sehemu nyingi), liwe dhahiri, na lijibiwe mara moja.
    - Usilete mada mpya au malengo mengine ya ziada.

  length_budget: |
    MIPAKA YA UREFU:
    - analysis<=60 herufi; follow-up<=120 herufi; expected_answer<=120 herufi.

  scoring_rule: "KANUNI YA ALAMA: Pima TU uhusiano na swali, ukamilifu, na usahihi wa maudhui. USIADHIBU mtindo au uundaji wa maandishi."

  strict_output: |-
    MATOKEO MAKALI (BILA MARKDOWN):
    - JSON tupu pekee, mstari MMOJA.
    - Tumia JSON iliyobanwa (hakuna nafasi karibu na ':' au ',').
    - Hakuna maandishi ya ziada.

whisper:
  enabled: true
  asset_model_path: "models/ggml-model-q4_0.bin"
  language: "sw" # "auto", "en", "ja", "sw"
  translate: false
  print_timestamp: false
  target_sample_rate: 16000
  record_sample_rates: [16000, 48000, 44100]
  compute_checksum: true

prompts:
  - nodeId: Q1
    prompt: |-
      Kazi:
      - Bainisha udhaifu (mfano: vipimo/viwango havijaelezwa, misimu haijatajwa, majibu ya kupindukia).
      - Toa jibu moja bora linalotarajiwa: wastani wa hasara ya mavuno kutokana na FAW katika misimu 3 iliyopita (% au magunia kwa ekari); taja kama kuna mabadiliko makubwa kati ya misimu.
      - Uliza swali 1 tu la ufuatiliaji ili KUTHIBITISHA/KUHAKIKI jibu hilo hilo (sentensi moja fupi). Pendelea kuthibitisha kipimo (asilimia vs magunia/ekari) na msingi wa kulinganisha au thamani kwa kila msimu kama haipo.
      - Toa alama 1–100 (nambari kamili).

      Swali: {{QUESTION}}
      Jibu: {{ANSWER}}

  - nodeId: Q2
    prompt: |-
      Kazi:
      - Bainisha udhaifu (mfano: ubadilishanaji hauko wazi, hakuna kipimo, hakuna sababu).
      - Toa jibu bora linalotarajiwa: kiasi cha kupunguza mavuno ambacho mkulima yuko tayari kukubali ili avune siku 10 mapema (% au magunia/ekari), pamoja na sababu fupi ya kipengele kimoja (mfano: hatari ya mvua/bei sokoni).
      - Uliza swali 1 tu la ufuatiliaji ili KUTHIBITISHA/KUHAKIKI jibu hilo hilo (sentensi moja fupi). Pendelea kufafanua kipimo/kiasi au mpaka wa juu wa hasara inayokubalika.
      - Toa alama 1–100 (nambari kamili).

      Swali: {{QUESTION}}
      Jibu: {{ANSWER}}

  - nodeId: Q3
    prompt: |-
      Kazi:
      - Bainisha udhaifu (mfano: hakuna kizingiti, kipimo hakiko wazi, wadudu na magonjwa vimechanganywa).
      - Toa jibu bora linalotarajiwa: kizingiti wazi cha kubadili aina (mfano: ≥X% ya mimea/masikio yenye uharibifu wa kiwango cha wastani au zaidi, au kiwango cha ukali katika hatua fulani ya ukuaji).
      - Uliza swali 1 tu la ufuatiliaji ili KUTHIBITISHA/KUHAKIKI jibu hilo hilo (sentensi moja fupi). Pendelea kuthibitisha kipimo/kiwango kinachotumika au dirisha la hatua ya ukuaji.
      - Toa alama 1–100 (nambari kamili).

      Swali: {{QUESTION}}
      Jibu: {{ANSWER}}

  - nodeId: Q4
    prompt: |-
      Kazi:
      - Bainisha udhaifu (mfano: sifa za jumla mno, hakuna namba/viwango).
      - Toa jibu bora linalotarajiwa: malengo 2 mafupi ya kuchukua nafasi ya aina ya sasa, kila moja likiwa na kigezo cha namba au cha kundi (mfano: DTM, uvumilivu wa FAW, uvumilivu wa ukame katika hatua fulani, mavuno ya kawaida).
      - Uliza swali 1 tu la ufuatiliaji ili KUTHIBITISHA/KUHAKIKI jibu hilo hilo (sentensi moja fupi). Pendelea kuthibitisha sifa ya kipaumbele cha kwanza au lengo la namba.
      - Toa alama 1–100 (nambari kamili).

      Swali: {{QUESTION}}
      Jibu: {{ANSWER}}

  - nodeId: Q5
    prompt: |-
      Kazi:
      - Bainisha udhaifu (mfano: hakuna msingi wa kulinganisha, hakuna kipimo, hakuna kanuni ya uamuzi).
      - Toa jibu bora linalotarajiwa: mavuno ya chini kabisa yanayokubalika katika mwaka mbaya (% ya mavuno ya kawaida au magunia/ekari) pamoja na kanuni fupi ya uamuzi (mfano: “nikipata angalau X, nitapanda tena”).
      - Uliza swali 1 tu la ufuatiliaji ili KUTHIBITISHA/KUHAKIKI jibu hilo hilo (sentensi moja fupi). Pendelea kuthibitisha wastani wa mavuno ya kawaida (baseline) au mfano wa mwaka mbaya kwa namba.
      - Toa alama 1–100 (nambari kamili).

      Swali: {{QUESTION}}
      Jibu: {{ANSWER}}

  - nodeId: Q6
    prompt: |-
      Kazi:
      - Bainisha udhaifu (mfano: muda ni wa jumla sana, hakuna hatua ya ukuaji, hakuna dalili/athari).
      - Toa jibu bora linalotarajiwa: hatua ya zao ambapo ukame ni hatari zaidi (mfano: kabla ya kutoa maua, wakati wa kutoa maua/kuchanua, kujaza punje, kabla ya kuvuna) pamoja na sababu fupi ya kipengele kimoja.
      - Uliza swali 1 tu la ufuatiliaji ili KUTHIBITISHA/KUHAKIKI jibu hilo hilo (sentensi moja fupi). Pendelea kuthibitisha maana ya hatua hiyo au mfano wa msimu mmoja maalum.
      - Toa alama 1–100 (nambari kamili).

      Swali: {{QUESTION}}
      Jibu: {{ANSWER}}

model_defaults:
  # Model download UI defaults
  default_model_url: "https://huggingface.co/google/gemma-3n-E4B-it-litert-lm/resolve/main/gemma-3n-E4B-it-int4.litertlm"
  default_file_name: "Gemma3n4B.litertlm"

  # Optional tuning knobs (keep same defaults as code)
  timeout_ms: 1800000          # 30 minutes
  ui_throttle_ms: 250
  ui_min_delta_bytes: 1048576  # 1 MiB
